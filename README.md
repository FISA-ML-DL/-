# ğŸ’³ ì±„ë¬´ ë¶ˆì´í–‰ ì—¬ë¶€ ì˜ˆì¸¡: ë¶ˆì´í–‰ì˜ ì§•í›„ë¥¼ ì°¾ì•„ë¼!

## ë°°ê²½
ì±„ë¬´ ë¶ˆì´í–‰ì€ ê¸ˆìœµ ê¸°ê´€ê³¼ ê°œì¸ ëª¨ë‘ì—ê²Œ í° ì˜í–¥ì„ ë¯¸ì¹˜ë©°, ê²½ì œ ì‹œìŠ¤í…œì— ë¶€ë‹´ UP
<br>íš¨ê³¼ì ìœ¼ë¡œ ì±„ë¬´ ë¶ˆì´í–‰ ì—¬ë¶€ë¥¼ ì˜ˆì¸¡í•  ìˆ˜ ìˆëŠ” ê¸°ìˆ ì€ ê¸ˆìœµ ì•ˆì •ì„±ì„ ë†’ì´ê³ , ê¸ˆìœµ ì„œë¹„ìŠ¤ ì œê³µìì™€ ê³ ê° ê°„ì˜ ì‹ ë¢°ë¥¼ ê°•í™”í•˜ëŠ” ë° í° ê¸°ì—¬í•˜ê¸°

## ì£¼ì œ
ì±„ë¬´ ë¶ˆì´í–‰ ê°€ëŠ¥ì„±ì„ ì˜ˆì¸¡í•˜ëŠ” AI ì•Œê³ ë¦¬ì¦˜ ê°œë°œ 

## ğŸ“Š ë°ì´í„° íŠ¹ì„±
- 19ê°œ ë…ë¦½ë³€ìˆ˜ (ìˆ˜ì¹˜í˜• 15ê°œ, ë²”ì£¼í˜• 4ê°œ)
- ì±„ë¬´ ë¶ˆì´í–‰ ì—¬ë¶€: 0(ì •ìƒ ìƒí™˜), 1(ì±„ë¬´ ë¶ˆì´í–‰)
- í´ë˜ìŠ¤ ë¶ˆê· í˜•: 1:1.8 â†’ ì†Œìˆ˜ í´ë˜ìŠ¤(ë¶ˆì´í–‰) ì˜ˆì¸¡ ì •í™•ë„ê°€ í•µì‹¬
  
## ë°ì´í„° ì „ì²˜ë¦¬ ì „ëµ
#### 1. ë°ì´í„° ì •ì œ  
| **ë‹¨ê³„** | **ë°©ë²•** | **ê·¼ê±°** |  
|------|------|------|  
| UID ì œê±° | UID ì»¬ëŸ¼ ì‚­ì œ | ê³ ìœ  ì‹ë³„ìëŠ” ëª¨ë¸ ì˜ˆì¸¡ë ¥ì— ê¸°ì—¬í•˜ì§€ ì•Šìœ¼ë©° ê³¼ì í•© ìœ ë°œ ê°€ëŠ¥ì„± |  
| ì´ìƒì¹˜ ì²˜ë¦¬ | IQR ê¸°ë°˜ Winsorizing ëŒ€ì‹  ì¤‘ì•™ê°’ ëŒ€ì²´ ì„ íƒ | íŠ¸ë¦¬ ê¸°ë°˜ ëª¨ë¸ì˜ ì´ìƒì¹˜ Robustness íŠ¹ì„± í™œìš© |  

#### 2. íŒŒìƒë³€ìˆ˜ ê³µí•™  
| **íŒŒìƒë³€ìˆ˜** | **ê¸ˆìœµì  í•´ì„** | **ìˆ˜í•™ì  í‘œí˜„** | **ì˜ˆìƒ ì˜í–¥ë ¥** |  
|----------|------------|--------------|--------------|  
| ì‹ ìš© ì ìˆ˜ ëŒ€ë¹„ ë¶€ì±„ ë¹„ìœ¨ | ì‹ ìš©ë“±ê¸‰ ëŒ€ë¹„ ì‹¤ì œ ë¶€ë‹´ë¥  | `ë¶€ì±„ ë¹„ìœ¨ / ì‹ ìš© ì ìˆ˜` | ìŒì˜ ìƒê´€ê´€ê³„ ì˜ˆìƒ |  
| ì—°ì²´ ë¦¬ìŠ¤í¬ ì§€í‘œ | ê³¼ê±° ì´ë ¥ ê¸°ë°˜ ë¯¸ë˜ ìœ„í—˜ ì˜ˆì¸¡ | `ë°œìƒ íšŸìˆ˜ Ã— ê²½ê³¼ ê°œì›”` | ì–‘ì˜ ìƒê´€ê´€ê³„ ì˜ˆìƒ |  
| ì›” ì†Œë“ ëŒ€ë¹„ ë¶€ì±„ ë¹„ìœ¨ | í˜„ê¸ˆíë¦„ ì•ˆì •ì„± í‰ê°€ | `ì›” ìƒí™˜ì•¡ / (ì—°ì†Œë“ / 12)` | ì„ê³„ê°’ ì´ˆê³¼ ì‹œ ìœ„í—˜ ì¦ê°€ |  
#### 3. ê²°ì¸¡ì¹˜ ì²˜ë¦¬ ì²´ê³„
ìˆ˜ì¹˜í˜• ë³€ìˆ˜:
- ì¤‘ì•™ê°’ ëŒ€ì²´ ì´ìœ :
    - ë¡œë²„ìŠ¤íŠ¸ í†µê³„ëŸ‰ìœ¼ë¡œ ê·¹ë‹¨ê°’ ì˜í–¥ ìµœì†Œí™”
    - `ì‹ ìš© ì ìˆ˜`Â ë“±ì˜ ë³€ìˆ˜ì—ì„œ Skewness ê´€ì°°
ë²”ì£¼í˜• ë³€ìˆ˜:
- 'Unknown'ì²˜ë¦¬ ì¥ì :
    - ì‹ ê·œ ë²”ì£¼ ì¶œí˜„ì‹œ ëŒ€ì‘ ê°€ëŠ¥
    - ëª¨ë¸ ë²”ì£¼ ê³ ì •ìœ¼ë¡œ ì•ˆì „ì„± í™•ë³´ 
#### 4. ì¸ì½”ë”© ì „ëµ ë¹„êµ
| **ë°©ë²•** | **ì¥ì ** | **ë‹¨ì ** | **ì„ íƒ ì´ìœ ** |
| --- | --- | --- | --- |
| Label Encoding | ì°¨ì› ì¦ê°€ ì—†ìŒ | ìˆœì„œ ì˜ë¯¸ ë¶€ì—¬ ê°€ëŠ¥ì„± | íŠ¸ë¦¬ ëª¨ë¸ì˜ ë¹„ì„ í˜•ì„± ëŒ€ì‘ |
| One-Hot | ìˆœì„œ ì˜í–¥ ì œê±° | ì°¨ì› í­ë°œ ë¬¸ì œ | ëŒ€ê·œëª¨ ë°ì´í„°ì— ë¹„íš¨ìœ¨ì  |
| Target Encoding | íƒ€ê²Ÿ ì •ë³´ ë°˜ì˜ | ê³¼ì í•© ìœ„í—˜ | ê²€ì¦ ë°ì´í„° ëˆ„ìˆ˜ ê°€ëŠ¥ì„± |

## í´ë˜ìŠ¤ ë¶ˆê· í˜• ëŒ€ì‘
#### 1. SMOTE ì‘ë™ ë©”ì»¤ë‹ˆì¦˜

```
graph LR
    A[ê¸°ì¡´ ì†Œìˆ˜ í´ë˜ìŠ¤] --> B[K-NN ê¸°ë°˜ ì´ì›ƒ íƒìƒ‰]
    B --> C[ì„ì˜ ë³´ê°„ë²•ìœ¼ë¡œ í•©ì„± ìƒ˜í”Œ ìƒì„±]
    C --> D[ê· í˜• ì¡íŒ ë°ì´í„° ë¶„í¬]
```

**ì ìš© ì„¸ë¶€ì‚¬í•­**:

- **k_neighbors=5**Â (ê¸°ë³¸ê°’) ìœ ì§€: ê³¼ë„í•œ ìƒ˜í”Œë§ ë°©ì§€
- **ë¶„í•  ì „ ì ìš©**: ê²€ì¦ ì„¸íŠ¸ì— ì •ë³´ ëˆ„ìˆ˜ ë°©ì§€
- **ì„±ëŠ¥ ë¹„êµ**: SMOTE vs ADASYN vs BorderlineSMOTE ì‹¤í—˜ ê³„íš

#### 2. ëŒ€ì²´ ê¸°ë²• ë¹„êµí‘œ

| **ë°©ë²•** | **ì›ë¦¬** | **ì¥ì ** | **ë‹¨ì ** |
| --- | --- | --- | --- |
| Undersampling | ë‹¤ìˆ˜ í´ë˜ìŠ¤ ì‚­ì œ | ê³„ì‚° íš¨ìœ¨ | ì •ë³´ ì†ì‹¤ |
| Class Weight | ì†ì‹¤ í•¨ìˆ˜ ê°€ì¤‘ì¹˜ | ë°ì´í„° ë³€í˜• ì—†ìŒ | ëª¨ë¸ íŠ¹ì • êµ¬í˜„ í•„ìš” |
| GAN | ìƒì„±ì  ì ëŒ€ ì‹ ê²½ë§ | ë³µì¡í•œ ë¶„í¬ í•™ìŠµ | í›ˆë ¨ ë¶ˆì•ˆì •ì„± |

---

## ì•™ìƒë¸” ëª¨ë¸ ì„¤ê³„

#### 1. ìŠ¤íƒœí‚¹ ì•„í‚¤í…ì²˜

```
graph TD
    A[Raw Features] --> B[LightGBM]
    A --> C[XGBoost]
    A --> D[CatBoost]
    B --> E[Meta Features]
    C --> E
    D --> E
    E --> F[Logistic Regression]
    A -->|Passthrough| F
```

#### 2. ê°œë³„ ëª¨ë¸ ìµœì í™” í¬ì¸íŠ¸

**LightGBM**:

- `num_leaves=31`: ë³µì¡ë„ ì œì–´
- `feature_fraction=0.9`: ê³¼ì í•© ë°©ì§€

**XGBoost**:

- `gamma=0`: ê°€ì§€ì¹˜ê¸° ì™„í™”
- `max_depth=6`: ì ì ˆí•œ ë³µì¡ë„

**CatBoost**:

- `grow_policy='SymmetricTree'`: ê· í˜• íŠ¸ë¦¬ êµ¬ì¡°
- `one_hot_max_size=10`: ìë™ ë²”ì£¼í˜• ì²˜ë¦¬

#### 3. ë©”íƒ€ í•™ìŠµê¸° ì„ íƒ ê·¼ê±°

- **ë¡œì§€ìŠ¤í‹± íšŒê·€**ì˜ ì„ í˜• ê²°í•© íŠ¹ì„±:
    - Base Learner ì˜ˆì¸¡ê°’ì˜ ê°€ì¤‘ í•© ìµœì í™”
    - ì €ì°¨ì› ë°ì´í„°ì—ì„œ ê³ ì„±ëŠ¥
- **Passthrough í™œì„±í™”**: ì›ë³¸ íŠ¹ì„± ë³´ì¡´ìœ¼ë¡œ ë©”íƒ€ ëª¨ë¸ì˜ ì„¤ëª…ë ¥ í–¥ìƒ

---

## ê²€ì¦ ë°©ë²•

#### 1. ê³„ì¸µí™” ë¶„í•  í”„ë¡œì„¸ìŠ¤

```
X_train, X_valid, y_train, y_valid = train_test_split(
    X_resampled, y_resampled,
    test_size=0.2,
    stratify=y_resampled,  # SMOTE ì ìš© í›„ ë¶„í¬ ë°˜ì˜
    random_state=42
)
```

#### 2. í‰ê°€ ì§€í‘œ ë¶„ì„

**ROC-AUC ì„ íƒ ì´ìœ **:

- ì„ê³„ê°’ ë¶ˆë¬¸ ì „ë°˜ì  ì„±ëŠ¥ í‰ê°€
- Precision-Recall ëŒ€ë¹„ ë¶ˆê· í˜• ë°ì´í„°ì— Robust
- ê¸ˆìœµ ë¦¬ìŠ¤í¬ ê´€ë¦¬ìì˜ ì˜ì‚¬ê²°ì • ìœ ì—°ì„± ì§€ì›

---

## ìµœì í™” ì „ëµ

#### 1. í•˜ì´í¼íŒŒë¼ë¯¸í„° ê³ ì •

- **random_state=42**: ì¬í˜„ì„± ë³´ì¥
- **early_stopping_rounds ë¯¸ì ìš©**: ì•™ìƒë¸”ì˜ ë‹¤ì–‘í•œ í•™ìŠµ ë³´ì¡´

#### 2. í…ŒìŠ¤íŠ¸ ë°ì´í„° íŒŒì´í”„ë¼ì¸

python

Copy

```
test = test[X_train.columns]  # í›ˆë ¨ í”¼ì²˜ ìˆœì„œ ê°•ì œ ë§ì¶¤
```


## ì‹¤í–‰ ê²°ê³¼

- **ê²€ì¦ AUC**: 0.8724 (ì˜ˆì‹œ)
- **ì œì¶œ íŒŒì¼ í˜•ì‹**:Â `UID`ì™€Â `Default Probability`Â ì»¬ëŸ¼ ë³´ì¡´
- **ì˜ˆì¸¡ê°’ ë¶„í¬**: ì–‘ê·¹í™” ë°©ì§€ë¥¼ ìœ„í•œ í™•ë¥  ë³´ì • ë¯¸ì ìš©


## ê°œì„  ê°€ëŠ¥ ë°©í–¥

#### 1. í•˜ì´í¼íŒŒë¼ë¯¸í„° íŠœë‹

| **ë„êµ¬** | **ì¥ì ** | **ì ìš© ê³„íš** |
| --- | --- | --- |
| Optuna | Bayesian ìµœì í™” | 100íšŒ Trial + 5-Fold CV |
| Hyperopt | Tree êµ¬ì¡° íƒìƒ‰ | ëª¨ë¸ë³„ ê°œë³„ íŠœë‹ |

#### 2. ì‹¬ì¸µ íŠ¹ì„± ê³µí•™

- **ìƒí˜¸ì‘ìš© í•­**:Â `ì‹ ìš© ì ìˆ˜ Ã— ì—°ì²´ ë¦¬ìŠ¤í¬`
- **ë¹„ì„ í˜• ë³€í™˜**:Â `log(ì—°ê°„ ì†Œë“ + 1)`
- **ì‹œê°„ ê°€ì¤‘ì¹˜**: ìµœê·¼ 6ê°œì›” ë°ì´í„° ê°•ì¡°

#### 3. ëª¨ë¸ í™•ì¥

- **Deep Learning**: Wide & Deep ì•„í‚¤í…ì²˜
- **í™•ë¥  ë³´ì •**: Platt Scaling ì ìš©
- **ë‹¤ë‹¨ê³„ ì•™ìƒë¸”**: 1ë‹¨ê³„ì—ì„œ Hard Sample ì„ ë³„ í›„ 2ë‹¨ê³„ ì§‘ì¤‘ í•™ìŠµ


## ê²°ë¡ 

ë³¸ í”„ë¡œì íŠ¸ëŠ”Â **ìŠ¤íƒœí‚¹ ì•™ìƒë¸”**ì„ ì¤‘ì‹¬ìœ¼ë¡œ í•œ ì¢…í•©ì  ì‹ ìš©ìœ„í—˜ ëª¨ë¸ë§ í”„ë ˆì„ì›Œí¬ë¥¼ ì œì‹œí–ˆìŠµë‹ˆë‹¤. ë°ì´í„° ì „ì²˜ë¦¬ ë‹¨ê³„ì—ì„œ ë„ë©”ì¸ ì§€ì‹ì„ ë°˜ì˜í•œ íŒŒìƒë³€ìˆ˜ ìƒì„±, SMOTEë¥¼ í™œìš©í•œ ë¶ˆê· í˜• ëŒ€ì‘, ë‹¤ì–‘í•œ íŠ¸ë¦¬ ëª¨ë¸ì˜ ì˜ˆì¸¡ë ¥ì„ ê²°í•©í•œ ì•™ìƒë¸” ê¸°ë²•ì´ í•µì‹¬ ì„±ê³µ ìš”ì¸ì…ë‹ˆë‹¤. í–¥í›„ í•˜ì´í¼íŒŒë¼ë¯¸í„° íŠœë‹ê³¼ ì‹¬ì¸µì  íŠ¹ì„± ë¶„ì„ì„ í†µí•´ AUC 0.9+ ë‹¬ì„±ì´ ê¸°ëŒ€ë©ë‹ˆë‹¤.


### ğŸ“š ë¶„ì„ ë° ì‹œê°í™”
<p align="center">
  <img src="./images/roc_curve.png" width="45%">
  <img src="./images/heatmap.png" width="45%">
</p>

### âš’ï¸ Libraries & Tools
![pandas](https://img.shields.io/badge/pandas-150458.svg?&style=for-the-badge&logo=pandas&logoColor=white)
![numpy](https://img.shields.io/badge/numpy-013243.svg?&style=for-the-badge&logo=numpy&logoColor=white)
![scikit-learn](https://img.shields.io/badge/scikitlearn-F7931E.svg?&style=for-the-badge&logo=scikitlearn&logoColor=white)
![xgboost](https://img.shields.io/badge/xgboost-3CC131.svg?&style=for-the-badge&logo=xgboost&logoColor=white)
![lightgbm](https://img.shields.io/badge/lightgbm-9C4A2D.svg?&style=for-the-badge&logo=lightgbm&logoColor=white)
![catboost](https://img.shields.io/badge/catboost-00A3FF.svg?&style=for-the-badge&logo=catboost&logoColor=white)
![optuna](https://img.shields.io/badge/optuna-4A90E2.svg?&style=for-the-badge&logo=optuna&logoColor=white)
![imbalanced-learn](https://img.shields.io/badge/imbalanced--learn-00A1E4.svg?&style=for-the-badge&logo=python&logoColor=white)
<br>
![Google Colab](https://img.shields.io/badge/Google_Colab-F9AB00.svg?&style=for-the-badge&logo=googlecolab&logoColor=white)
![GitHub](https://img.shields.io/badge/github-181717.svg?&style=for-the-badge&logo=github&logoColor=white)


### ğŸ”§ íŠ¸ëŸ¬ë¸”ìŠˆíŒ… íšŒê³ 
#### 1. 


#### 2. 


#### 3. 




